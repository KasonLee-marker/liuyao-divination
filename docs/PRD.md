# 六爻预测App 产品需求文档 (PRD)

## 文档信息

| 项目 | 内容 |
|------|------|
| 产品名称 | 六爻预测 |
| 版本 | 1.0.0 |
| 文档状态 | 初稿 |
| 创建日期 | 2026-02-27 |
| 目标平台 | Windows 11 桌面应用 |

---

## 1. 产品概述

### 1.1 产品定位

六爻预测App是一款基于中国传统易学文化的离线预测工具，采用六爻占卜方法，为用户提供便捷、准确的卦象解读服务。应用完全离线运行，无需网络连接，保护用户隐私。

### 1.2 目标用户

| 用户群体 | 特征描述 |
|----------|----------|
| 易学爱好者 | 对中国传统文化和易学有兴趣的用户 |
| 专业预测师 | 需要工具辅助进行专业预测的从业者 |
| 普通用户 | 生活中遇到困惑，希望通过传统方式寻求指引的用户 |

### 1.3 核心价值

- **离线可用**：无需网络，随时随地使用
- **操作简单**：直观的起卦流程，降低使用门槛
- **解读详尽**：提供卦象、爻辞、变卦等多维度解读
- **数据安全**：所有数据本地存储，隐私有保障

---

## 2. 功能需求

### 2.1 功能架构图

```
六爻预测App
├── 起卦模块
│   ├── 手动起卦
│   ├── 时间起卦
│   ├── 数字起卦
│   └── 铜钱起卦（模拟）
├── 解卦模块
│   ├── 卦象解读
│   ├── 爻辞详解
│   ├── 变卦分析
│   ├── 综合判断
│   └── AI智能解卦（可选）
├── 历史记录
│   ├── 记录列表
│   ├── 记录详情
│   ├── 搜索筛选
│   └── 导出功能
├── 知识库
│   ├── 六十四卦详解
│   ├── 爻辞库
│   ├── 五行生克
│   └── 用神选取
└── 系统设置
    ├── 外观设置
    ├── 数据管理
    ├── AI设置
    └── 关于信息
```

### 2.2 功能详细说明

#### 2.2.1 起卦模块

##### 2.2.1.1 手动起卦

| 项目 | 描述 |
|------|------|
| 功能描述 | 用户手动输入六个爻的阴阳属性 |
| 输入方式 | 点击/切换每个爻的阴阳状态 |
| 交互设计 | 从下往上排列六个爻位，点击切换阴/阳/老阴/老阳 |
| 输出结果 | 生成完整卦象，包含本卦和变卦 |

##### 2.2.1.2 时间起卦

| 项目 | 描述 |
|------|------|
| 功能描述 | 根据农历时间自动生成卦象 |
| 输入参数 | 年、月、日、时（支持公历转农历） |
| 计算规则 | 上卦 = (年+月+日) % 8，下卦 = (年+月+日+时) % 8，动爻 = (年+月+日+时) % 6 |
| 输出结果 | 完整卦象及动爻位置 |

##### 2.2.1.3 数字起卦

| 项目 | 描述 |
|------|------|
| 功能描述 | 根据用户输入的数字生成卦象 |
| 输入参数 | 两个数字（1-9999） |
| 计算规则 | 上卦 = 数字1 % 8，下卦 = 数字2 % 8，动爻 = (数字1+数字2) % 6 |
| 输出结果 | 完整卦象及动爻位置 |

##### 2.2.1.4 铜钱起卦（模拟）

| 项目 | 描述 |
|------|------|
| 功能描述 | 模拟传统铜钱起卦方法 |
| 操作流程 | 用户点击"掷铜钱"按钮，每次掷三枚铜钱，共掷6次 |
| 计算规则 | 3正=老阳，2正1反=少阳，1正2反=少阴，3反=老阴 |
| 动画效果 | 铜钱翻转动画，增强仪式感 |
| 输出结果 | 完整卦象，包含动爻 |

#### 2.2.2 解卦模块

##### 2.2.2.1 卦象解读

| 项目 | 描述 |
|------|------|
| 显示内容 | 卦名、卦象图、卦辞、卦义 |
| 卦象图示 | 阴阳爻图形化展示，动爻标记 |
| 卦辞来源 | 周易原文 |

##### 2.2.2.2 爻辞详解

| 项目 | 描述 |
|------|------|
| 显示内容 | 每一爻的爻辞及解释 |
| 重点标注 | 动爻爻辞高亮显示 |
| 解释层次 | 原文 + 白话翻译 + 详细解释 |

##### 2.2.2.3 变卦分析

| 项目 | 描述 |
|------|------|
| 功能描述 | 展示本卦变变卦的过程和结果 |
| 显示内容 | 本卦、变卦、变卦卦辞 |
| 对比展示 | 并排展示本卦和变卦，动爻变化清晰可见 |

##### 2.2.2.4 综合判断

| 项目 | 描述 |
|------|------|
| 功能描述 | 提供综合性的预测结果解读 |
| 分析维度 | 用神、原神、忌神、仇神分析 |
| 五行关系 | 生克冲合分析 |
| 断语输出 | 根据卦象组合生成断语 |

##### 2.2.2.5 AI智能解卦（可选功能）

| 项目 | 描述 |
|------|------|
| 功能描述 | 结合用户问题和卦象，通过本地AI模型生成通俗易懂的解卦内容 |
| 技术方案 | 基于Ollama本地大语言模型 |
| 使用方式 | 用户可选择开启，非必选功能 |
| 输出内容 | 针对用户问题的个性化解读、建议和注意事项 |

**功能详细说明：**

| 子功能 | 描述 |
|--------|------|
| AI模型检测 | 自动检测系统是否安装Ollama及可用模型 |
| 一键安装引导 | 未安装时提供安装指引和下载链接 |
| 模型选择 | 支持选择不同的本地模型（如qwen、llama等） |
| 智能解读 | 根据卦象、爻辞、变卦、用户问题生成综合解读 |
| 解读风格 | 通俗易懂，避免专业术语，适合小白用户 |

**AI解读内容结构：**

```
1. 卦象总览
   - 本卦含义简述
   - 变卦含义简述（如有）
   - 整体吉凶趋势

2. 针对问题分析
   - 结合用户所问事项
   - 动爻变化的影响
   - 关键时间节点提示

3. 建议与注意事项
   - 行动建议
   - 需要避免的事项
   - 有利因素和不利因素

4. 总结
   - 核心结论
   - 后续发展方向
```

**用户交互流程：**

```
解卦结果页面
    │
    ├── [AI智能解读] 按钮（首次使用显示"开启AI解读"）
    │
    ├── 点击后检测Ollama
    │   ├── 已安装 → 选择模型 → 生成解读
    │   └── 未安装 → 显示安装引导
    │                  ├── [下载Ollama] 按钮
    │                  ├── 安装说明
    │                  └── [我已安装，重新检测] 按钮
    │
    └── 解读生成中...
        └── 显示AI解读内容
```

**Ollama安装引导内容：**

| 项目 | 内容 |
|------|------|
| 下载地址 | https://ollama.ai |
| 推荐模型 | qwen2.5:7b（中文友好，约4.7GB） |
| 最低配置 | 8GB内存，10GB磁盘空间 |
| 安装命令 | `ollama pull qwen2.5:7b` |

**技术实现要点：**

| 项目 | 说明 |
|------|------|
| API地址 | http://localhost:11434/api/generate |
| 请求方式 | POST |
| 超时设置 | 60秒 |
| 流式输出 | 支持逐字显示，提升用户体验 |
| 错误处理 | 网络超时、模型不可用等异常提示 |

**Prompt模板设计：**

```
你是一位精通六爻预测的易学大师，请用通俗易懂的语言解读以下卦象。

【用户问题】{question}
【本卦】{original_hexagram_name}：{original_hexagram_description}
【卦辞】{guaci}
【变卦】{changed_hexagram_name}（如有）
【动爻】{moving_yao_info}

请从以下角度解读：
1. 这个卦象整体意味着什么？
2. 针对用户的问题，有什么具体启示？
3. 有什么建议和注意事项？

请用白话文回答，避免使用专业术语，让普通人也能理解。
```

#### 2.2.3 历史记录

##### 2.2.3.1 记录管理

| 功能 | 描述 |
|------|------|
| 保存记录 | 自动保存每次起卦结果 |
| 记录信息 | 起卦时间、起卦方式、卦象、问题备注、AI解读内容 |
| 删除记录 | 支持单条删除和批量删除 |
| 编辑备注 | 可添加/修改预测问题的备注 |
| AI解读保存 | AI解读内容自动保存到历史记录，查看历史时可恢复 |

##### 2.2.3.2 搜索筛选

| 功能 | 描述 |
|------|------|
| 时间筛选 | 按日期范围筛选 |
| 卦名筛选 | 按卦名搜索 |
| 关键词搜索 | 搜索备注内容 |

##### 2.2.3.3 导出功能

| 功能 | 描述 |
|------|------|
| 导出格式 | PDF、TXT、JSON |
| 导出内容 | 卦象图 + 解读内容 |

#### 2.2.4 知识库

##### 2.2.4.1 六十四卦详解

| 内容 | 描述 |
|------|------|
| 卦名 | 六十四卦名称 |
| 卦象 | 阴阳爻排列 |
| 卦辞 | 周易原文 |
| 彖辞 | 卦义解释 |
| 象辞 | 卦象解释 |
| 现代解读 | 通俗易懂的解释 |

##### 2.2.4.2 五行生克

| 内容 | 描述 |
|------|------|
| 五行属性 | 金木水火土基本属性 |
| 相生关系 | 金生水、水生木、木生火、火生土、土生金 |
| 相克关系 | 金克木、木克土、土克水、水克火、火克金 |
| 地支五行 | 十二地支对应的五行属性 |
| 天干五行 | 十天干对应的五行属性 |

##### 2.2.4.3 用神选取

| 内容 | 描述 |
|------|------|
| 用神概念 | 根据预测事项确定用神 |
| 分类指南 | 财运、事业、婚姻、健康等不同事项的用神选取方法 |

#### 2.2.5 系统设置

##### 2.2.5.1 外观设置

| 设置项 | 选项 |
|--------|------|
| 主题 | 浅色/深色/跟随系统 |
| 字体大小 | 小/中/大 |
| 卦象样式 | 传统/现代 |

##### 2.2.5.2 数据管理

| 功能 | 描述 |
|------|------|
| 数据备份 | 导出所有数据为JSON文件 |
| 数据恢复 | 从备份文件恢复数据 |
| 数据清空 | 清除所有历史记录 |

##### 2.2.5.3 AI设置

| 设置项 | 选项 |
|--------|------|
| AI功能开关 | 开启/关闭AI智能解卦功能 |
| Ollama地址 | 默认 http://localhost:11434，可自定义 |
| 模型选择 | 下拉选择已安装的模型 |
| 温度参数 | 0.1-1.0，控制回答的创造性 |
| 最大字数 | 500-2000字，控制回答长度 |

---

## 3. 非功能需求

### 3.1 性能要求

| 指标 | 要求 |
|------|------|
| 启动时间 | ≤ 3秒 |
| 起卦响应 | ≤ 100毫秒 |
| 解卦计算 | ≤ 500毫秒 |
| 内存占用 | ≤ 200MB |

### 3.2 可用性要求

| 指标 | 要求 |
|------|------|
| 离线可用 | 100%功能离线可用 |
| 数据持久化 | 本地存储，数据不丢失 |
| 容错处理 | 输入异常时给出友好提示 |

### 3.3 安全性要求

| 指标 | 要求 |
|------|------|
| 数据安全 | 所有数据本地存储，不上传云端 |
| 隐私保护 | 不收集用户个人信息 |

### 3.4 兼容性要求

| 指标 | 要求 |
|------|------|
| 操作系统 | Windows 11 (x64, ARM64) |
| 分辨率 | 支持 1366x768 及以上 |

---

## 4. 用户界面设计

### 4.1 设计原则

- **简洁直观**：界面布局清晰，操作流程简单
- **文化传承**：融入中国传统文化元素
- **现代美观**：符合现代UI设计规范

### 4.2 主要界面

#### 4.2.1 主界面

```
┌─────────────────────────────────────────────────────┐
│  六爻预测                              [─] [□] [×]  │
├─────────────────────────────────────────────────────┤
│  [起卦]  [历史]  [知识库]  [设置]                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│   ┌─────────────────────────────────────────────┐   │
│   │              起 卦 方 式                     │   │
│   │                                             │   │
│   │   ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐      │   │
│   │   │手动 │  │时间 │  │数字 │  │铜钱 │      │   │
│   │   │起卦 │  │起卦 │  │起卦 │  │起卦 │      │   │
│   │   └─────┘  └─────┘  └─────┘  └─────┘      │   │
│   │                                             │   │
│   └─────────────────────────────────────────────┘   │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 4.2.2 卦象展示界面

```
┌─────────────────────────────────────────────────────┐
│  卦象解读                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│   本卦                    变卦                      │
│   ┌───┐                  ┌───┐                     │
│   │ ▀▀▀│ 六爻             │ ▀▀▀│ 六爻              │
│   │▀▀ ▀▀│ 五爻            │▀▀ ▀▀│ 五爻             │
│   │ ▀▀▀│ 四爻             │ ▀▀▀│ 四爻              │
│   │▀▀ ▀▀│ 三爻 ●动爻      │ ▀▀▀│ 三爻              │
│   │ ▀▀▀│ 二爻             │ ▀▀▀│ 二爻              │
│   │▀▀ ▀▀│ 初爻            │▀▀ ▀▀│ 初爻             │
│   └───┘                  └───┘                     │
│   水雷屯                 水火既济                   │
│                                                     │
├─────────────────────────────────────────────────────┤
│  卦辞：元亨利贞，勿用有攸往，利建侯。              │
├─────────────────────────────────────────────────────┤
│  [查看详细解读]                                     │
└─────────────────────────────────────────────────────┘
```

---

## 5. 数据需求

### 5.1 内置数据

| 数据类型 | 数据量 | 说明 |
|----------|--------|------|
| 六十四卦信息 | 64条 | 卦名、卦象、卦辞、爻辞等 |
| 天干地支 | 22条 | 十天干、十二地支属性 |
| 五行信息 | 5条 | 五行属性及生克关系 |
| 纳甲信息 | 48条 | 六十四卦纳甲配置 |

### 5.2 用户数据

| 数据类型 | 存储方式 | 说明 |
|----------|----------|------|
| 历史记录 | SQLite | 起卦记录及解读结果 |
| 用户设置 | JSON文件 | 界面偏好设置 |

---

## 6. 里程碑计划

| 阶段 | 内容 | 交付物 |
|------|------|--------|
| 第一阶段 | 基础框架搭建 | 项目框架、基础UI组件 |
| 第二阶段 | 核心功能开发 | 起卦模块、解卦模块 |
| 第三阶段 | 辅助功能开发 | 历史记录、知识库 |
| 第四阶段 | 优化完善 | 性能优化、Bug修复 |
| 第五阶段 | 发布 | 安装包、用户手册 |

---

## 7. 风险评估

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 易学理论准确性 | 中 | 引用权威典籍，标注出处 |
| 用户体验复杂度 | 中 | 简化操作流程，提供引导 |
| 技术选型风险 | 低 | 采用成熟技术栈 |

---

## 8. 附录

### 8.1 术语表

| 术语 | 解释 |
|------|------|
| 六爻 | 易经卦象中的六个爻位，从下到上依次为初爻、二爻、三爻、四爻、五爻、上爻 |
| 本卦 | 起卦得到的原始卦象 |
| 变卦 | 动爻变化后得到的新卦象 |
| 动爻 | 发生变化的爻，老阳变阴，老阴变阳 |
| 用神 | 预测时所依据的主要爻位 |
| 纳甲 | 将天干地支纳入六爻的方法 |

### 8.2 参考资料

- 《周易正义》
- 《增删卜易》
- 《卜筮正宗》
